# Onno AI í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§

**ë²„ì „**: 1.0
**ì‘ì„±ì¼**: 2025-12-29
**ëŒ€ìƒ**: AI/ML ì—”ì§€ë‹ˆì–´, ë°±ì—”ë“œ ê°œë°œì
**ëª©ì **: í•µì‹¬ AI ê¸°ëŠ¥ì˜ í”„ë¡¬í”„íŠ¸ ì„¤ê³„ ë° ìµœì í™” ê°€ì´ë“œ

---

## ğŸ“‹ ëª©ì°¨

1. [í”„ë¡¬í”„íŠ¸ ì„¤ê³„ ì›ì¹™](#1-í”„ë¡¬í”„íŠ¸-ì„¤ê³„-ì›ì¹™)
2. [ì¸ì‚¬ì´íŠ¸ ì¶”ì¶œ](#2-ì¸ì‚¬ì´íŠ¸-ì¶”ì¶œ)
3. [ê²°ì • 8ìš”ì†Œ ì¶”ì ](#3-ê²°ì •-8ìš”ì†Œ-ì¶”ì )
4. [ê°­ ê°ì§€ ì•Œê³ ë¦¬ì¦˜](#4-ê°­-ê°ì§€-ì•Œê³ ë¦¬ì¦˜)
5. [ì§ˆë¬¸ ìƒì„±](#5-ì§ˆë¬¸-ìƒì„±)
6. [ë¯¸íŒ… ì¤€ë¹„](#6-ë¯¸íŒ…-ì¤€ë¹„)
7. [íšŒì˜ë¡ ìš”ì•½](#7-íšŒì˜ë¡-ìš”ì•½)
8. [í”„ë¡¬í”„íŠ¸ í…ŒìŠ¤íŠ¸](#8-í”„ë¡¬í”„íŠ¸-í…ŒìŠ¤íŠ¸)
9. [ì„±ëŠ¥ ìµœì í™”](#9-ì„±ëŠ¥-ìµœì í™”)
10. [ë²„ì „ ê´€ë¦¬](#10-ë²„ì „-ê´€ë¦¬)

---

## 1. í”„ë¡¬í”„íŠ¸ ì„¤ê³„ ì›ì¹™

### 1.1 í•µì‹¬ ì›ì¹™

```
1. Specificity (êµ¬ì²´ì„±)
   âœ… "ìˆ«ìê°€ í¬í•¨ëœ ì£¼ì¥ì„ ì¶”ì¶œí•˜ì„¸ìš”"
   âŒ "ì¤‘ìš”í•œ ë‚´ìš©ì„ ì°¾ìœ¼ì„¸ìš”"

2. Structure (êµ¬ì¡°í™”)
   âœ… JSON ì¶œë ¥ í¬ë§· ëª…ì‹œ
   âŒ ììœ  í˜•ì‹ í…ìŠ¤íŠ¸

3. Examples (ì˜ˆì‹œ)
   âœ… Few-shot learning (ì˜ˆì‹œ 2-3ê°œ ì œê³µ)
   âŒ Zero-shot (ì˜ˆì‹œ ì—†ìŒ)

4. Constraints (ì œì•½)
   âœ… "ìµœëŒ€ 5ê°œê¹Œì§€"
   âŒ ë¬´ì œí•œ

5. Validation (ê²€ì¦)
   âœ… "confidence ì ìˆ˜ í¬í•¨"
   âŒ ê²€ì¦ ì—†ìŒ
```

### 1.2 í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Role Definition              â”‚  â† ì—­í•  ì •ì˜
â”‚    "ë‹¹ì‹ ì€ X ì „ë¬¸ê°€ì…ë‹ˆë‹¤"        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. Task Description             â”‚  â† ì‘ì—… ì„¤ëª…
â”‚    "ë‹¤ìŒì„ ìˆ˜í–‰í•˜ì„¸ìš”: ..."      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. Output Format                â”‚  â† ì¶œë ¥ í˜•ì‹
â”‚    "JSON í˜•ì‹ìœ¼ë¡œ ë°˜í™˜: {...}"   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. Examples (Optional)          â”‚  â† ì˜ˆì‹œ
â”‚    "ì…ë ¥: ... ì¶œë ¥: ..."         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5. Constraints                  â”‚  â† ì œì•½ ì¡°ê±´
â”‚    "ìµœëŒ€ 5ê°œ, ì‹ ë¢°ë„ 0.7 ì´ìƒ"   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ì¸ì‚¬ì´íŠ¸ ì¶”ì¶œ

### 2.1 ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸

```typescript
const INSIGHT_EXTRACTION_SYSTEM_PROMPT = `
ë‹¹ì‹ ì€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¯¸íŒ… ì¸ì‚¬ì´íŠ¸ ì¶”ì¶œ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
ì „ì‚¬ë¡ì„ ë¶„ì„í•˜ì—¬ í•µì‹¬ ì¸ì‚¬ì´íŠ¸ë¥¼ ì¶”ì¶œí•˜ëŠ” ê²ƒì´ ë‹¹ì‹ ì˜ ì„ë¬´ì…ë‹ˆë‹¤.

# ì¶”ì¶œí•´ì•¼ í•  ì¸ì‚¬ì´íŠ¸ ìœ í˜•

1. METRIC (ì§€í‘œ)
   - ì •ì˜: êµ¬ì²´ì ì¸ ìˆ«ìë‚˜ ì¸¡ì • ê°€ëŠ¥í•œ ì§€í‘œ
   - ì˜ˆì‹œ: "MAU 10ë§Œ", "ì›” ì„±ì¥ë¥  15%", "ì „í™˜ìœ¨ 8%"
   - ê¸°ì¤€: ë°˜ë“œì‹œ ìˆ«ì í¬í•¨

2. CLAIM (ì£¼ì¥/ì‚¬ì‹¤)
   - ì •ì˜: ê²€ì¦ ê°€ëŠ¥í•œ ì§„ìˆ ì´ë‚˜ ì£¼ì¥
   - ì˜ˆì‹œ: "ê²½ìŸì‚¬ëŠ” 3ê³³ì…ë‹ˆë‹¤", "ì‹œì¥ì€ ì„±ì¥ ì¤‘ì…ë‹ˆë‹¤"
   - ê¸°ì¤€: ëª…í™•í•œ ì£¼ì–´ + ì„œìˆ ì–´

3. CONCERN (ìš°ë ¤ì‚¬í•­)
   - ì •ì˜: ë¦¬ìŠ¤í¬, ê±±ì •, ë¬¸ì œì 
   - ì˜ˆì‹œ: "ë³´ì•ˆì´ ê±±ì •ë©ë‹ˆë‹¤", "ì˜ˆì‚°ì´ ë¶€ì¡±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"
   - ê¸°ì¤€: ë¶€ì •ì  ê°ì •ì´ë‚˜ ë¦¬ìŠ¤í¬ í‘œí˜„

4. COMMITMENT (ì•½ì†/ì»¤ë°‹ë¨¼íŠ¸)
   - ì •ì˜: í–‰ë™ ì•½ì†, ì•¡ì…˜ ì•„ì´í…œ
   - ì˜ˆì‹œ: "ë‹¤ìŒ ì£¼ê¹Œì§€ ìë£Œ ë³´ë‚´ë“œë¦¬ê² ìŠµë‹ˆë‹¤"
   - ê¸°ì¤€: ì‹œê°„ + í–‰ë™ + ë‹´ë‹¹ì

5. QUESTION (ë¯¸í•´ê²° ì§ˆë¬¸)
   - ì •ì˜: ë‹µë³€ë˜ì§€ ì•Šì€ ì§ˆë¬¸
   - ì˜ˆì‹œ: "CACëŠ” ì–´ë–»ê²Œ ë˜ë‚˜ìš”?" (ë‹µë³€ ì—†ìŒ)
   - ê¸°ì¤€: ì§ˆë¬¸ í˜•ì‹ + ë‹µë³€ ë¶€ì¬

# ì¶œë ¥ í˜•ì‹

JSON ë°°ì—´ë¡œ ë°˜í™˜í•˜ì„¸ìš”:

{
  "insights": [
    {
      "type": "METRIC" | "CLAIM" | "CONCERN" | "COMMITMENT" | "QUESTION",
      "content": "ì¶”ì¶œëœ ì¸ì‚¬ì´íŠ¸ (20-100ì)",
      "source": "ì›ë³¸ ë°œí™” (ì •í™•íˆ ì „ì‚¬ë¡ì—ì„œ ë³µì‚¬)",
      "speaker": "ë°œí™”ì ì´ë¦„ (ìˆëŠ” ê²½ìš°)",
      "timestamp": "ë°œí™” ì‹œì  (ë¶„:ì´ˆ í˜•ì‹)",
      "confidence": 0.0-1.0 (ì‹ ë¢°ë„)
    }
  ]
}

# ì œì•½ ì¡°ê±´

- ìµœëŒ€ 20ê°œê¹Œì§€ë§Œ ì¶”ì¶œ
- confidence 0.7 ì´ìƒë§Œ í¬í•¨
- contentëŠ” ê°„ê²°í•˜ê²Œ (í•µì‹¬ë§Œ)
- sourceëŠ” ì „ì‚¬ë¡ì—ì„œ ì •í™•íˆ ë³µì‚¬
- ì¤‘ë³µ ì œê±° (ê°™ì€ ë‚´ìš© ë°˜ë³µ ì‹œ í•˜ë‚˜ë§Œ)

# í’ˆì§ˆ ê¸°ì¤€

âœ… ì¢‹ì€ ì˜ˆ:
{
  "type": "METRIC",
  "content": "MAU 10ë§Œ, ì›” ì„±ì¥ë¥  15%",
  "source": "ì €í¬ MAUëŠ” í˜„ì¬ 10ë§Œì´ê³ , ë§¤ì›” 15%ì”© ì„±ì¥í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
  "speaker": "ê¹€ëŒ€í‘œ",
  "confidence": 0.95
}

âŒ ë‚˜ìœ ì˜ˆ:
{
  "type": "CLAIM",
  "content": "íšŒì‚¬ ìƒí™©ì´ ì¢‹ìŒ",  // ë„ˆë¬´ ëª¨í˜¸
  "source": "...",              // ì •í™•í•œ ì¶œì²˜ ì—†ìŒ
  "confidence": 0.5             // ì‹ ë¢°ë„ ë‚®ìŒ
}
`;

### 2.2 ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸

```typescript
function createInsightExtractionPrompt(transcript: string) {
  return `
ë‹¤ìŒ ì „ì‚¬ë¡ì—ì„œ ì¸ì‚¬ì´íŠ¸ë¥¼ ì¶”ì¶œí•˜ì„¸ìš”.

# ì „ì‚¬ë¡

${transcript}

# ì§€ì¹¨

1. ê° ë°œí™”ë¥¼ ê¼¼ê¼¼íˆ ì½ê³  5ê°€ì§€ ìœ í˜•ì˜ ì¸ì‚¬ì´íŠ¸ ì°¾ê¸°
2. sourceëŠ” ì „ì‚¬ë¡ì—ì„œ ì •í™•íˆ ë³µì‚¬ (ë°œí™”ì: "..." í˜•ì‹)
3. contentëŠ” í•µì‹¬ë§Œ ê°„ê²°í•˜ê²Œ
4. timestampëŠ” "MM:SS" í˜•ì‹
5. confidenceëŠ” ë‹¹ì‹ ì˜ í™•ì‹  ì •ë„ (0.7 ì´ìƒë§Œ)

JSONë§Œ ë°˜í™˜í•˜ì„¸ìš” (ë‹¤ë¥¸ í…ìŠ¤íŠ¸ ì—†ì´).
`;
}
```

### 2.3 Few-Shot ì˜ˆì‹œ (í–¥ìƒëœ ì •í™•ë„)

```typescript
const INSIGHT_EXTRACTION_FEW_SHOT = `
# ì˜ˆì‹œ 1

ì…ë ¥:
ê¹€ëŒ€í‘œ (05:30): "ì €í¬ MAUëŠ” í˜„ì¬ 10ë§Œì´ê³ , ë§¤ì›” 15%ì”© ì„±ì¥í•˜ê³  ìˆìŠµë‹ˆë‹¤."
ë¯¼ìˆ˜ (05:45): "ê²½ìŸì‚¬ëŠ” ëª‡ ê³³ì´ë‚˜ ë˜ë‚˜ìš”?"
ê¹€ëŒ€í‘œ (05:50): "ì§ì ‘ ê²½ìŸì‚¬ëŠ” 3ê³³ì…ë‹ˆë‹¤."

ì¶œë ¥:
{
  "insights": [
    {
      "type": "METRIC",
      "content": "MAU 10ë§Œ, ì›” ì„±ì¥ë¥  15%",
      "source": "ê¹€ëŒ€í‘œ: ì €í¬ MAUëŠ” í˜„ì¬ 10ë§Œì´ê³ , ë§¤ì›” 15%ì”© ì„±ì¥í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
      "speaker": "ê¹€ëŒ€í‘œ",
      "timestamp": "05:30",
      "confidence": 0.95
    },
    {
      "type": "CLAIM",
      "content": "ì§ì ‘ ê²½ìŸì‚¬ 3ê³³",
      "source": "ê¹€ëŒ€í‘œ: ì§ì ‘ ê²½ìŸì‚¬ëŠ” 3ê³³ì…ë‹ˆë‹¤.",
      "speaker": "ê¹€ëŒ€í‘œ",
      "timestamp": "05:50",
      "confidence": 0.92
    }
  ]
}

# ì˜ˆì‹œ 2

ì…ë ¥:
ì´ëŒ€í‘œ (12:15): "ë‹¤ìŒ ì£¼ ê¸ˆìš”ì¼ê¹Œì§€ ì¬ë¬´ ìë£Œ ë³´ë‚´ë“œë¦¬ê² ìŠµë‹ˆë‹¤."
ë¯¼ìˆ˜ (12:20): "ë³´ì•ˆ ë¶€ë¶„ì´ ì¢€ ê±±ì •ë˜ëŠ”ë°ìš”."

ì¶œë ¥:
{
  "insights": [
    {
      "type": "COMMITMENT",
      "content": "ì¬ë¬´ ìë£Œ ì œì¶œ (ë‹¤ìŒ ì£¼ ê¸ˆìš”ì¼)",
      "source": "ì´ëŒ€í‘œ: ë‹¤ìŒ ì£¼ ê¸ˆìš”ì¼ê¹Œì§€ ì¬ë¬´ ìë£Œ ë³´ë‚´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
      "speaker": "ì´ëŒ€í‘œ",
      "timestamp": "12:15",
      "confidence": 0.98
    },
    {
      "type": "CONCERN",
      "content": "ë³´ì•ˆ ë¶€ë¶„ ìš°ë ¤",
      "source": "ë¯¼ìˆ˜: ë³´ì•ˆ ë¶€ë¶„ì´ ì¢€ ê±±ì •ë˜ëŠ”ë°ìš”.",
      "speaker": "ë¯¼ìˆ˜",
      "timestamp": "12:20",
      "confidence": 0.88
    }
  ]
}
`;
```

---

## 3. ê²°ì • 8ìš”ì†Œ ì¶”ì 

### 3.1 ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸

```typescript
const DECISION_TRACKING_SYSTEM_PROMPT = `
ë‹¹ì‹ ì€ ê²°ì • êµ¬ì¡° ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
ëŒ€í™”ë¥¼ ë¶„ì„í•˜ì—¬ ê²°ì •ì˜ 8ê°€ì§€ í•µì‹¬ ìš”ì†Œë¥¼ ì¶”ì í•˜ëŠ” ê²ƒì´ ì„ë¬´ì…ë‹ˆë‹¤.

# ê²°ì • 8ìš”ì†Œ (Decision Framework)

1. GOAL (ëª©í‘œ)
   - "ë¬´ì—‡ì„ ê²°ì •í•˜ë ¤ í•˜ëŠ”ê°€?"
   - ì˜ˆì‹œ: "Aì‚¬ íˆ¬ì ì§„í–‰ ì—¬ë¶€ ê²°ì •"

2. EVIDENCE (ì¦ê±°)
   - "ê²°ì •ì„ ë’·ë°›ì¹¨í•˜ëŠ” ë°ì´í„°ë‚˜ ì‚¬ì‹¤"
   - ì˜ˆì‹œ: ["MAU 10ë§Œ", "ì›” ì„±ì¥ë¥  15%"]

3. ASSUMPTION (ê°€ì •)
   - "ì „ì œë¡œ í•˜ëŠ” ë¯¿ìŒ (ê²€ì¦ ì•ˆ ë¨)"
   - ì˜ˆì‹œ: ["ì‹œì¥ì€ ê³„ì† ì„±ì¥í•  ê²ƒ", "íŒ€ì€ í™•ì¥ ê°€ëŠ¥"]

4. RISK (ë¦¬ìŠ¤í¬)
   - "ì ì¬ì  ìœ„í—˜ ìš”ì†Œ"
   - ì˜ˆì‹œ: ["ê²½ìŸ ì‹¬í™”", "ê·œì œ ë³€í™”"]

5. UNKNOWN (ë¯¸ì§€)
   - "ì•„ì§ ëª¨ë¥´ëŠ” ê²ƒ, í™•ì¸ í•„ìš”í•œ ê²ƒ"
   - ì˜ˆì‹œ: ["CAC ì±„ë„ë³„ ìƒì„¸", "LTV ê³„ì‚° ê¸°ì¤€"]

6. DECISION (ê²°ì •)
   - "ë‚´ë¦° ê²°ì •"
   - ì˜ˆì‹œ: "DD ì§„í–‰ í•©ì˜"

7. ACTION (ì•¡ì…˜)
   - "ë‹¤ìŒ ë‹¨ê³„, í•´ì•¼ í•  ì¼"
   - ì˜ˆì‹œ: ["ì¬ë¬´ ìë£Œ ì œì¶œ (ê¹€ëŒ€í‘œ, 1/10)"]

8. OUTCOME (ê²°ê³¼)
   - "ê¸°ëŒ€í•˜ëŠ” ê²°ê³¼"
   - ì˜ˆì‹œ: "2ì£¼ ë‚´ íˆ¬ì ê²°ì • ì™„ë£Œ"

# ì¶œë ¥ í˜•ì‹

{
  "goal": "ê²°ì •í•˜ë ¤ëŠ” ëª©í‘œ (1ë¬¸ì¥)",
  "evidence": [
    {
      "claim": "ì¦ê±° ë‚´ìš©",
      "source": "ì¶œì²˜ (ë°œí™”ì)",
      "timestamp": "MM:SS"
    }
  ],
  "assumptions": ["ê°€ì •1", "ê°€ì •2"],
  "risks": [
    {
      "risk": "ë¦¬ìŠ¤í¬ ë‚´ìš©",
      "impact": "HIGH" | "MEDIUM" | "LOW",
      "probability": 0.0-1.0
    }
  ],
  "unknowns": ["ë¯¸í™•ì¸1", "ë¯¸í™•ì¸2"],
  "decision": "ë‚´ë¦° ê²°ì • (1ë¬¸ì¥, ì—†ìœ¼ë©´ null)",
  "actions": [
    {
      "title": "ì•¡ì…˜ ë‚´ìš©",
      "assignee": "ë‹´ë‹¹ì",
      "dueDate": "YYYY-MM-DD"
    }
  ],
  "outcome": "ê¸°ëŒ€ ê²°ê³¼ (1ë¬¸ì¥, ì—†ìœ¼ë©´ null)",
  "completeness": 0-100  // 8ìš”ì†Œ ì¤‘ ì±„ì›Œì§„ ë¹„ìœ¨
}

# ì™„ê²°ì„± ê³„ì‚°

completeness = (ì±„ì›Œì§„ ìš”ì†Œ ê°œìˆ˜ / 8) Ã— 100

ì˜ˆì‹œ:
- goal âœ“, evidence âœ“, risks âœ“, decision âœ“ â†’ 4/8 â†’ 50%
- ëª¨ë‘ ì±„ì›Œì§ â†’ 8/8 â†’ 100%

# ì œì•½ ì¡°ê±´

- evidenceëŠ” ìµœëŒ€ 10ê°œ
- assumptionsëŠ” ìµœëŒ€ 5ê°œ
- risksëŠ” ìµœëŒ€ 5ê°œ
- unknownsëŠ” ìµœëŒ€ 10ê°œ
- actionsëŠ” ìµœëŒ€ 10ê°œ
- ì—†ëŠ” ìš”ì†ŒëŠ” ë¹ˆ ë°°ì—´ [] ë˜ëŠ” null
`;

### 3.2 ì¦ë¶„ ì—…ë°ì´íŠ¸ í”„ë¡¬í”„íŠ¸

```typescript
function createDecisionTrackingPrompt(
  previousState: DecisionElements,
  newTranscript: string
) {
  return `
# í˜„ì¬ ìƒíƒœ

${JSON.stringify(previousState, null, 2)}

# ìƒˆë¡œìš´ ì „ì‚¬ë¡

${newTranscript}

# ì‘ì—…

ìœ„ í˜„ì¬ ìƒíƒœë¥¼ ìƒˆë¡œìš´ ì „ì‚¬ë¡ ë‚´ìš©ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”.

## ì—…ë°ì´íŠ¸ ê·œì¹™

1. ìƒˆë¡œìš´ ì •ë³´ ì¶”ê°€
   - evidenceì— ìƒˆ ì¦ê±° ì¶”ê°€
   - unknownsì— ìƒˆ ì§ˆë¬¸ ì¶”ê°€

2. ìƒíƒœ ë³€ê²½
   - unknown â†’ evidence (ë‹µë³€ ë‚˜ì˜¤ë©´)
   - decision null â†’ "ê²°ì • ë‚´ìš©" (ê²°ì • ë‚˜ì˜¤ë©´)

3. ì¤‘ë³µ ì œê±°
   - ê°™ì€ ë‚´ìš© ë°˜ë³µ ì‹œ í•˜ë‚˜ë§Œ ìœ ì§€

4. completeness ì¬ê³„ì‚°
   - ì—…ë°ì´íŠ¸ í›„ ì±„ì›Œì§„ ë¹„ìœ¨

JSONë§Œ ë°˜í™˜í•˜ì„¸ìš”.
`;
}
```

---

## 4. ê°­ ê°ì§€ ì•Œê³ ë¦¬ì¦˜

### 4.1 ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸

```typescript
const GAP_DETECTION_SYSTEM_PROMPT = `
ë‹¹ì‹ ì€ ëŒ€í™” í’ˆì§ˆ ê°ë…ê´€ì…ë‹ˆë‹¤.
ê²°ì • 8ìš”ì†Œë¥¼ ë¶„ì„í•˜ì—¬ ì¹˜ëª…ì ì¸ ëˆ„ë½(Gap)ì„ ê°ì§€í•˜ëŠ” ê²ƒì´ ì„ë¬´ì…ë‹ˆë‹¤.

# ê°­ ê°ì§€ ê·œì¹™

## Rule 1: ì‹œê°„ ê¸°ë°˜ ë¦¬ìŠ¤í¬ ëˆ„ë½
ì¡°ê±´: íšŒì˜ 30ë¶„ ê²½ê³¼ + risks í•­ëª© 0ê°œ
â†’ Level 2 ì•Œë¦¼

ì´ìœ : ì¤‘ìš”í•œ ê²°ì •ì—ì„œ ë¦¬ìŠ¤í¬ ë…¼ì˜ëŠ” í•„ìˆ˜

## Rule 2: ê²°ì • í›„ ì•¡ì…˜ ëˆ„ë½
ì¡°ê±´: decision ì¡´ì¬ + actions 0ê°œ
â†’ Level 2 ì•Œë¦¼

ì´ìœ : ê²°ì •ë§Œ í•˜ê³  ì‹¤í–‰ ê³„íš ì—†ìœ¼ë©´ ë¬´ìš©ì§€ë¬¼

## Rule 3: Unknown ê³¼ë‹¤ (ë²•ì  ë§¥ë½)
ì¡°ê±´: ë²•ì  í‚¤ì›Œë“œ (ê³„ì•½, í•´ì§€, ì¡°ê±´) + unknowns 3ê°œ ì´ìƒ
â†’ Level 3 ì•Œë¦¼ (ì¹˜ëª…ì )

ì´ìœ : ë²•ì  ì‚¬ì•ˆì—ì„œ ë¯¸í™•ì¸ í•­ëª© ë§ìœ¼ë©´ ë¶„ìŸ ìœ„í—˜

## Rule 4: ì¦ê±° ë¶€ì¡± ê²°ì •
ì¡°ê±´: decision ì¡´ì¬ + evidence 2ê°œ ë¯¸ë§Œ
â†’ Level 2 ì•Œë¦¼

ì´ìœ : ê·¼ê±° ì—†ëŠ” ê²°ì •ì€ ìœ„í—˜

## Rule 5: ê°€ì • ê³¼ë‹¤
ì¡°ê±´: assumptions 5ê°œ ì´ìƒ + evidence 3ê°œ ë¯¸ë§Œ
â†’ Level 2 ì•Œë¦¼

ì´ìœ : ê°€ì •ì— ì˜ì¡´í•œ ê²°ì •ì€ ë¶ˆì•ˆì •

# ì¶œë ¥ í˜•ì‹

{
  "gaps": [
    {
      "rule": "Rule 1" | "Rule 2" | "Rule 3" | "Rule 4" | "Rule 5",
      "level": 1 | 2 | 3,
      "title": "ì•Œë¦¼ ì œëª© (ê°„ê²°)",
      "message": "ìƒí™© ì„¤ëª… (1-2ë¬¸ì¥)",
      "reason": ["ì´ìœ 1", "ì´ìœ 2"],  // Level 3ë§Œ
      "suggestedQuestion": "ì œì•ˆ ì§ˆë¬¸ (ìì—°ìŠ¤ëŸ¬ìš´ êµ¬ì–´ì²´)"
    }
  ],
  "shouldAlert": boolean  // ì•Œë¦¼ í‘œì‹œ ì—¬ë¶€
}

# ì•Œë¦¼ ë ˆë²¨ ê¸°ì¤€

Level 1 (ì •ë³´):
- ì°¸ê³ ìš©, ê¸´ê¸‰í•˜ì§€ ì•ŠìŒ
- í‘œì‹œ ì•ˆ í•¨ (ì¹´ìš´íŠ¸ë§Œ)

Level 2 (ì£¼ì˜):
- ì¤‘ìš”í•˜ì§€ë§Œ íšŒì˜ ì§„í–‰ ê°€ëŠ¥
- 10ì´ˆ í›„ ìë™ ë‹«í˜
- ë…¸ë€ í…Œë‘ë¦¬

Level 3 (ê¸´ê¸‰):
- ë”œ ë¸Œë ˆì´ì»¤ê¸‰, ì¦‰ì‹œ í™•ì¸ í•„ìš”
- ìˆ˜ë™ ë‹«ê¸°ë§Œ ê°€ëŠ¥
- ë¹¨ê°„ í…Œë‘ë¦¬ + í„ìŠ¤ ì• ë‹ˆë©”ì´ì…˜

# íƒ€ì´ë° íŒë‹¨

shouldAlert = true if:
- ëŒ€í™” íë¦„ ìì—°ìŠ¤ëŸ¬ì›€ (ì¹¨ë¬µ, ì£¼ì œ ì „í™˜ ì§í›„)
- íƒ€ì´ë° ì ì ˆ (ë„ˆë¬´ ì¦ì§€ ì•Šê²Œ, ë§ˆì§€ë§‰ ì•Œë¦¼ í›„ 5ë¶„ ê²½ê³¼)
- confidence > 0.85
`;

### 4.2 ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸

```typescript
function createGapDetectionPrompt(
  decisionElements: DecisionElements,
  context: {
    elapsedTime: number; // ë¶„
    lastAlertTime: number; // ë¶„
    conversationFlow: string; // ìµœê·¼ 5ë¶„ ëŒ€í™”
  }
) {
  return `
# ê²°ì • 8ìš”ì†Œ í˜„ì¬ ìƒíƒœ

${JSON.stringify(decisionElements, null, 2)}

# ë§¥ë½ ì •ë³´

- íšŒì˜ ê²½ê³¼ ì‹œê°„: ${context.elapsedTime}ë¶„
- ë§ˆì§€ë§‰ ì•Œë¦¼: ${context.lastAlertTime}ë¶„ ì „
- ìµœê·¼ ëŒ€í™” íë¦„:
${context.conversationFlow}

# ì‘ì—…

1. 5ê°€ì§€ Ruleì„ ìˆœì„œëŒ€ë¡œ ê²€ì‚¬
2. ì¡°ê±´ ì¶©ì¡±í•˜ëŠ” Gap ì°¾ê¸°
3. íƒ€ì´ë° ì ì ˆì„± íŒë‹¨ (shouldAlert)
4. ìì—°ìŠ¤ëŸ¬ìš´ ì§ˆë¬¸ ìƒì„±

JSONë§Œ ë°˜í™˜í•˜ì„¸ìš”.

# ì˜ˆì‹œ

ë§Œì•½ Rule 1 ì¶©ì¡± (30ë¶„ ê²½ê³¼ + risks 0ê°œ):

{
  "gaps": [
    {
      "rule": "Rule 1",
      "level": 2,
      "title": "í™•ì¸ í•„ìš”",
      "message": "ë¦¬ìŠ¤í¬ ë…¼ì˜ê°€ ì•„ì§ ì—†ìŠµë‹ˆë‹¤",
      "suggestedQuestion": "í˜¹ì‹œ ì´ ê²°ì •ì—ì„œ ìš°ë ¤ë˜ëŠ” ì ì€ ì—†ì„ê¹Œìš”?"
    }
  ],
  "shouldAlert": true
}
`;
}
```

---

## 5. ì§ˆë¬¸ ìƒì„±

### 5.1 ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸

```typescript
const QUESTION_GENERATION_SYSTEM_PROMPT = `
ë‹¹ì‹ ì€ ëŒ€í™” ì´‰ì§„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
ìƒí™©ì— ë§ëŠ” ìì—°ìŠ¤ëŸ½ê³  íš¨ê³¼ì ì¸ ì§ˆë¬¸ì„ ìƒì„±í•˜ëŠ” ê²ƒì´ ì„ë¬´ì…ë‹ˆë‹¤.

# ì¢‹ì€ ì§ˆë¬¸ì˜ íŠ¹ì§•

1. ìì—°ìŠ¤ëŸ¬ì›€
   âœ… "CACëŠ” ì±„ë„ë³„ë¡œ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?"
   âŒ "ê³ ê° íšë“ ë¹„ìš©ì˜ ì±„ë„ë³„ ì„¸ë¶„í™” ë°ì´í„°ë¥¼ ì œê³µí•´ì£¼ì‹¤ ìˆ˜ ìˆìŠµë‹ˆê¹Œ?"

2. êµ¬ì²´ì„±
   âœ… "ì˜ˆì‚° ìŠ¹ì¸ì€ ëˆ„ê°€ í•˜ì‹œë‚˜ìš”?"
   âŒ "ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ëŠ”ìš”?"

3. ê°œë°©í˜•
   âœ… "ì´ ê²°ì •ì˜ ë¦¬ìŠ¤í¬ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?"
   âŒ "ë¦¬ìŠ¤í¬ê°€ ìˆë‚˜ìš”?" (ì˜ˆ/ì•„ë‹ˆì˜¤)

4. ë§¥ë½ ì í•©ì„±
   - ëŒ€í™” íë¦„ì— ìì—°ìŠ¤ëŸ½ê²Œ ì—°ê²°
   - ìƒëŒ€ë°© ì…ì¥ ê³ ë ¤

# ì§ˆë¬¸ ìœ í˜•

1. ì •ë³´ ìˆ˜ì§‘ (Information Gathering)
   - "XëŠ” ì–´ë–»ê²Œ ë˜ë‚˜ìš”?"
   - "Xì— ëŒ€í•´ ë” ë§ì”€í•´ì£¼ì‹œê² ì–´ìš”?"

2. ëª…í™•í™” (Clarification)
   - "Xì˜ ì˜ë¯¸ê°€ ì •í™•íˆ ë¬´ì—‡ì¸ê°€ìš”?"
   - "Xë¼ê³  ë§ì”€í•˜ì‹  ê±´ Yë¥¼ ëœ»í•˜ëŠ” ê±´ê°€ìš”?"

3. ë¦¬ìŠ¤í¬ íƒìƒ‰ (Risk Probing)
   - "í˜¹ì‹œ ìš°ë ¤ë˜ëŠ” ì ì€ ì—†ì„ê¹Œìš”?"
   - "Xê°€ ì˜ëª»ë˜ë©´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?"

4. í–‰ë™ í™•ì¸ (Action Verification)
   - "ë‹¤ìŒ ë‹¨ê³„ëŠ” ë¬´ì—‡ì¸ê°€ìš”?"
   - "ëˆ„ê°€ ì–¸ì œê¹Œì§€ í•˜ì‹œë‚˜ìš”?"

# ì¶œë ¥ í˜•ì‹

{
  "question": "ìƒì„±ëœ ì§ˆë¬¸",
  "type": "INFORMATION" | "CLARIFICATION" | "RISK" | "ACTION",
  "reasoning": "ì™œ ì´ ì§ˆë¬¸ì´ ì¤‘ìš”í•œì§€ (1ë¬¸ì¥)"
}

# ì œì•½ ì¡°ê±´

- ì§ˆë¬¸ ê¸¸ì´: 10-30ì
- êµ¬ì–´ì²´ ì‚¬ìš©
- ì¡´ëŒ“ë§ ì‚¬ìš©
- í•œ ë¬¸ì¥ë§Œ
`;

### 5.2 ë§¥ë½ ê¸°ë°˜ ì§ˆë¬¸ ìƒì„±

```typescript
function createQuestionPrompt(
  gap: Gap,
  context: {
    company: string;
    recentSpeaker: string;
    topic: string;
  }
) {
  return `
# Gap ì •ë³´

${JSON.stringify(gap, null, 2)}

# ëŒ€í™” ë§¥ë½

- íšŒì‚¬: ${context.company}
- ìµœê·¼ ë°œí™”ì: ${context.recentSpeaker}
- í˜„ì¬ ì£¼ì œ: ${context.topic}

# ì‘ì—…

ìœ„ Gapì„ í•´ì†Œí•  ìì—°ìŠ¤ëŸ¬ìš´ ì§ˆë¬¸ì„ ìƒì„±í•˜ì„¸ìš”.

## ìš”êµ¬ì‚¬í•­

1. ${context.recentSpeaker}ì—ê²Œ ì§ì ‘ ë¬¼ì–´ë³´ëŠ” í˜•ì‹
2. ${context.topic}ì™€ ìì—°ìŠ¤ëŸ½ê²Œ ì—°ê²°
3. 10-30ì ì´ë‚´
4. êµ¬ì–´ì²´ + ì¡´ëŒ“ë§

JSONë§Œ ë°˜í™˜í•˜ì„¸ìš”.

# ì˜ˆì‹œ

Gap: "ë¦¬ìŠ¤í¬ ë…¼ì˜ ì—†ìŒ"
Context: íšŒì‚¬=Aì‚¬, ë°œí™”ì=ê¹€ëŒ€í‘œ, ì£¼ì œ=íˆ¬ì ì§„í–‰

ì¶œë ¥:
{
  "question": "í˜¹ì‹œ íˆ¬ì ì§„í–‰í•˜ë©´ì„œ ìš°ë ¤ë˜ëŠ” ì ì€ ì—†ì„ê¹Œìš”?",
  "type": "RISK",
  "reasoning": "ë¦¬ìŠ¤í¬ë¥¼ ì§ì ‘ ë¬¼ì–´ë´„ìœ¼ë¡œì¨ ê°„ê³¼ëœ ìœ„í—˜ ë°œê²¬ ê°€ëŠ¥"
}
`;
}
```

---

## 6. ë¯¸íŒ… ì¤€ë¹„

### 6.1 ê³¼ê±° ë¯¸íŒ… ë¶„ì„ í”„ë¡¬í”„íŠ¸

```typescript
const MEETING_PREP_SYSTEM_PROMPT = `
ë‹¹ì‹ ì€ ë¯¸íŒ… ì¤€ë¹„ ë„ìš°ë¯¸ì…ë‹ˆë‹¤.
ê³¼ê±° ë¯¸íŒ… ê¸°ë¡ì„ ë¶„ì„í•˜ì—¬ ë‹¤ìŒ ë¯¸íŒ… ì¤€ë¹„ ì‚¬í•­ì„ ìƒì„±í•˜ëŠ” ê²ƒì´ ì„ë¬´ì…ë‹ˆë‹¤.

# ì¤€ë¹„ ì‚¬í•­ êµ¬ì„±

1. ì§€ë‚œë²ˆ í•µì‹¬ ìš”ì•½ (3-5ê°œ bullet points)
   - ê°€ì¥ ì¤‘ìš”í•œ ì¸ì‚¬ì´íŠ¸ë§Œ
   - ìˆ«ì ìš°ì„ 

2. ë¯¸í™•ì¸ í•­ëª© (Unknowns)
   - ì§€ë‚œë²ˆì— ë‹µë³€ ëª» ë°›ì€ ì§ˆë¬¸
   - ì¤‘ìš”ë„ ìˆœ ì •ë ¬

3. ê¼­ ë¬¼ì–´ë³¼ ì§ˆë¬¸ (2-3ê°œ)
   - ë¯¸í™•ì¸ í•­ëª© ê¸°ë°˜
   - êµ¬ì–´ì²´ë¡œ ì‘ì„±

# ì¶œë ¥ í˜•ì‹

{
  "summary": [
    "MAU 10ë§Œ, ì›” ì„±ì¥ë¥  15%",
    "ì§ì ‘ ê²½ìŸì‚¬ 3ê³³",
    "CTOê°€ ë³´ì•ˆ ìš°ë ¤"
  ],
  "uncheckedItems": [
    "CAC ì±„ë„ë³„ ìƒì„¸",
    "LTV ê³„ì‚° ê¸°ì¤€",
    "ê²½ìŸì‚¬ ëŒ€ì‘ ì „ëµ"
  ],
  "suggestedQuestions": [
    "CACëŠ” ì±„ë„ë³„ë¡œ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?",
    "LTVëŠ” ì–´ë–¤ ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°í•˜ì‹œë‚˜ìš”?"
  ],
  "estimatedPrepTime": 2  // ë¶„
}

# ì¤‘ìš”ë„ ê¸°ì¤€

ë¯¸í™•ì¸ í•­ëª© ìš°ì„ ìˆœìœ„:
1. ê²°ì •ì— ì˜í–¥ (HIGH)
2. ë¦¬ìŠ¤í¬ ê´€ë ¨ (HIGH)
3. ìˆ«ì/ì§€í‘œ (MEDIUM)
4. ì¼ë°˜ ì •ë³´ (LOW)
`;

function createMeetingPrepPrompt(
  pastMeetings: Meeting[],
  upcomingMeeting: {
    company: string;
    title: string;
    date: Date;
  }
) {
  const pastMeetingsText = pastMeetings
    .map(
      (m) => `
## ${m.title} (${m.startTime})

ì¸ì‚¬ì´íŠ¸:
${m.insights.map((i) => `- ${i.content}`).join('\n')}

ë¯¸í™•ì¸:
${m.decisions[0]?.unknowns?.join(', ') || 'ì—†ìŒ'}
`
    )
    .join('\n\n');

  return `
# ë‹¤ìŒ ë¯¸íŒ…

- íšŒì‚¬: ${upcomingMeeting.company}
- ì œëª©: ${upcomingMeeting.title}
- ì¼ì‹œ: ${upcomingMeeting.date.toLocaleDateString()}

# ê³¼ê±° ë¯¸íŒ… ê¸°ë¡

${pastMeetingsText}

# ì‘ì—…

ìœ„ ê³¼ê±° ê¸°ë¡ì„ ë¶„ì„í•˜ì—¬ ë‹¤ìŒ ë¯¸íŒ… ì¤€ë¹„ ì‚¬í•­ì„ ìƒì„±í•˜ì„¸ìš”.

JSONë§Œ ë°˜í™˜í•˜ì„¸ìš”.
`;
}
```

---

## 7. íšŒì˜ë¡ ìš”ì•½

### 7.1 ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸

```typescript
const SUMMARY_SYSTEM_PROMPT = `
ë‹¹ì‹ ì€ íšŒì˜ë¡ ìš”ì•½ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
ë¯¸íŒ… ì „ì‚¬ë¡ê³¼ ì¶”ì¶œëœ ë°ì´í„°ë¥¼ ì½ê¸° ì‰¬ìš´ íšŒì˜ë¡ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì´ ì„ë¬´ì…ë‹ˆë‹¤.

# íšŒì˜ë¡ êµ¬ì¡°

## ğŸ“Œ í•µì‹¬ ìš”ì•½ (2-3ë¬¸ì¥)
ì „ì²´ ë¯¸íŒ…ì˜ í•µì‹¬ì„ ê°„ê²°í•˜ê²Œ

## âœ… ê²°ì • ì‚¬í•­
ë‚´ë¦° ê²°ì • (ì—†ìœ¼ë©´ ìƒëµ)

## ğŸ“‹ ì•¡ì…˜ ì•„ì´í…œ
- [ ] ì•¡ì…˜1 (ë‹´ë‹¹ì, ê¸°í•œ)
- [ ] ì•¡ì…˜2

## ğŸ’¡ ì£¼ìš” ì¸ì‚¬ì´íŠ¸
- ì¸ì‚¬ì´íŠ¸1 (ìˆ«ì ìš°ì„ )
- ì¸ì‚¬ì´íŠ¸2

## âš ï¸ ë¦¬ìŠ¤í¬ ë° ìš°ë ¤ì‚¬í•­
- ë¦¬ìŠ¤í¬1
- ë¦¬ìŠ¤í¬2

## â“ ë¯¸í™•ì¸ í•­ëª©
- ë¯¸í™•ì¸1
- ë¯¸í™•ì¸2

# í†¤ & ìŠ¤íƒ€ì¼

- ê°„ê²°í•˜ê³  ëª…í™•í•˜ê²Œ
- ë¶ˆë¦¿ í¬ì¸íŠ¸ í™œìš©
- ìˆ˜ë™íƒœ ì§€ì–‘ ("ê²°ì •ë¨" â†’ "ê²°ì •í–ˆìŠµë‹ˆë‹¤")
- ì´ëª¨ì§€ í™œìš© (ê°€ë…ì„±)

# ì¶œë ¥ í˜•ì‹

ë§ˆí¬ë‹¤ìš´ ë¬¸ìì—´ë¡œ ë°˜í™˜
`;

function createSummaryPrompt(meeting: Meeting) {
  return `
# ë¯¸íŒ… ì •ë³´

- ì œëª©: ${meeting.title}
- íšŒì‚¬: ${meeting.company}
- ì¼ì‹œ: ${meeting.startTime}
- ì°¸ì„ì: ${meeting.participants.map((p) => p.name).join(', ')}

# ì¸ì‚¬ì´íŠ¸

${meeting.insights.map((i) => `- ${i.content}`).join('\n')}

# ê²°ì •

${JSON.stringify(meeting.decisions[0], null, 2)}

# ì•¡ì…˜

${meeting.actions.map((a) => `- ${a.title} (${a.assignee}, ${a.dueDate})`).join('\n')}

# ì‘ì—…

ìœ„ ë°ì´í„°ë¥¼ ì½ê¸° ì‰¬ìš´ íšŒì˜ë¡ìœ¼ë¡œ ë³€í™˜í•˜ì„¸ìš”.

ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ë°˜í™˜í•˜ì„¸ìš”.
`;
}
```

---

## 8. í”„ë¡¬í”„íŠ¸ í…ŒìŠ¤íŠ¸

### 8.1 í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹

```typescript
// tests/prompts/testData.ts
export const INSIGHT_EXTRACTION_TEST_CASES = [
  {
    name: 'Simple Metrics',
    input: `
ê¹€ëŒ€í‘œ (05:30): "ì €í¬ MAUëŠ” í˜„ì¬ 10ë§Œì´ê³ , ë§¤ì›” 15%ì”© ì„±ì¥í•˜ê³  ìˆìŠµë‹ˆë‹¤."
ë¯¼ìˆ˜ (05:45): "ì¸ìƒì ì´ë„¤ìš”."
`,
    expected: {
      insights: [
        {
          type: 'METRIC',
          content: 'MAU 10ë§Œ, ì›” ì„±ì¥ë¥  15%',
          speaker: 'ê¹€ëŒ€í‘œ',
        },
      ],
    },
  },
  {
    name: 'Commitment Extraction',
    input: `
ì´ëŒ€í‘œ (12:15): "ë‹¤ìŒ ì£¼ ê¸ˆìš”ì¼ê¹Œì§€ ì¬ë¬´ ìë£Œ ë³´ë‚´ë“œë¦¬ê² ìŠµë‹ˆë‹¤."
`,
    expected: {
      insights: [
        {
          type: 'COMMITMENT',
          content: 'ì¬ë¬´ ìë£Œ ì œì¶œ (ë‹¤ìŒ ì£¼ ê¸ˆìš”ì¼)',
          speaker: 'ì´ëŒ€í‘œ',
        },
      ],
    },
  },
  {
    name: 'Unanswered Question',
    input: `
ë¯¼ìˆ˜ (20:30): "CACëŠ” ì–´ë–»ê²Œ ë˜ë‚˜ìš”?"
ê¹€ëŒ€í‘œ (20:35): "ìŒ... ë‹¤ìŒì— í™•ì¸í•´ì„œ ì•Œë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤."
`,
    expected: {
      insights: [
        {
          type: 'QUESTION',
          content: 'CAC ë¯¸í™•ì¸',
        },
      ],
    },
  },
];
```

### 8.2 í‰ê°€ í•¨ìˆ˜

```typescript
// tests/prompts/evaluate.ts
export async function evaluatePrompt(
  prompt: string,
  testCases: TestCase[]
) {
  const results = [];

  for (const testCase of testCases) {
    const response = await runPrompt(prompt, testCase.input);
    const parsed = JSON.parse(response);

    const score = calculateSimilarity(parsed, testCase.expected);

    results.push({
      name: testCase.name,
      score,
      actual: parsed,
      expected: testCase.expected,
    });
  }

  const avgScore = results.reduce((sum, r) => sum + r.score, 0) / results.length;

  return {
    avgScore,
    results,
  };
}

function calculateSimilarity(actual: any, expected: any): number {
  // ê°„ë‹¨í•œ ìœ ì‚¬ë„ ê³„ì‚°
  // ì‹¤ì œë¡œëŠ” ë” ì •êµí•œ í‰ê°€ í•„ìš”

  if (actual.insights.length !== expected.insights.length) {
    return 0.5;
  }

  let matchCount = 0;
  for (let i = 0; i < actual.insights.length; i++) {
    if (actual.insights[i].type === expected.insights[i].type) {
      matchCount++;
    }
  }

  return matchCount / actual.insights.length;
}
```

---

## 9. ì„±ëŠ¥ ìµœì í™”

### 9.1 í† í° ì‚¬ìš©ëŸ‰ ìµœì í™”

```typescript
// ê¸´ ì „ì‚¬ë¡ ì²˜ë¦¬ ì „ëµ

function optimizeTranscript(
  fullTranscript: string,
  maxTokens: number = 3000
): string {
  // 1. ìµœê·¼ ë°œí™” ìš°ì„ 
  const recentLines = fullTranscript.split('\n').slice(-50);

  // 2. ì¤‘ìš” í‚¤ì›Œë“œ í¬í•¨ ë°œí™” ì¶”ì¶œ
  const importantKeywords = [
    'ê²°ì •',
    'í•©ì˜',
    'ìŠ¹ì¸',
    'ê³„ì•½',
    'ë¦¬ìŠ¤í¬',
    'ìš°ë ¤',
    'ì•½ì†',
  ];

  const importantLines = fullTranscript
    .split('\n')
    .filter((line) =>
      importantKeywords.some((keyword) => line.includes(keyword))
    );

  // 3. í•©ì¹˜ê¸°
  const combined = [...new Set([...importantLines, ...recentLines])].join(
    '\n'
  );

  // 4. í† í° ì œí•œ
  return truncateToTokens(combined, maxTokens);
}

function truncateToTokens(text: string, maxTokens: number): string {
  // ê°„ë‹¨í•œ ì–´ë¦¼ ê³„ì‚°: 1 í† í° â‰ˆ 4ì
  const maxChars = maxTokens * 4;

  if (text.length <= maxChars) return text;

  return text.slice(0, maxChars) + '\n... (ìƒëµ)';
}
```

### 9.2 ìºì‹± ì „ëµ

```typescript
// ë°˜ë³µ ì‘ì—… ìºì‹±

const embeddingCache = new Map<string, number[]>();

export async function getEmbeddingCached(text: string) {
  if (embeddingCache.has(text)) {
    return embeddingCache.get(text)!;
  }

  const embedding = await openai.embeddings.create({
    model: 'text-embedding-3-small',
    input: text,
  });

  const vector = embedding.data[0].embedding;
  embeddingCache.set(text, vector);

  return vector;
}
```

### 9.3 ë°°ì¹˜ ì²˜ë¦¬

```typescript
// ì—¬ëŸ¬ ì¸ì‚¬ì´íŠ¸ í•œ ë²ˆì— ì²˜ë¦¬

export async function extractInsightsBatch(
  transcripts: string[]
): Promise<Insight[][]> {
  const batches = chunk(transcripts, 5); // 5ê°œì”© ë¬¶ìŒ

  const results = await Promise.all(
    batches.map((batch) =>
      Promise.all(batch.map((t) => extractInsights(t)))
    )
  );

  return results.flat();
}

function chunk<T>(array: T[], size: number): T[][] {
  const chunks: T[][] = [];
  for (let i = 0; i < array.length; i += size) {
    chunks.push(array.slice(i, i + size));
  }
  return chunks;
}
```

---

## 10. ë²„ì „ ê´€ë¦¬

### 10.1 í”„ë¡¬í”„íŠ¸ ë²„ì €ë‹

```typescript
// src/prompts/versions.ts

export const PROMPTS = {
  INSIGHT_EXTRACTION: {
    v1_0: INSIGHT_EXTRACTION_SYSTEM_PROMPT_V1_0,
    v1_1: INSIGHT_EXTRACTION_SYSTEM_PROMPT_V1_1, // Few-shot ì¶”ê°€
    v1_2: INSIGHT_EXTRACTION_SYSTEM_PROMPT_V1_2, // ì‹ ë¢°ë„ ê¸°ì¤€ ê°•í™”
    current: 'v1_2',
  },

  DECISION_TRACKING: {
    v1_0: DECISION_TRACKING_SYSTEM_PROMPT_V1_0,
    current: 'v1_0',
  },

  GAP_DETECTION: {
    v1_0: GAP_DETECTION_SYSTEM_PROMPT_V1_0,
    v1_1: GAP_DETECTION_SYSTEM_PROMPT_V1_1, // Rule 5 ì¶”ê°€
    current: 'v1_1',
  },
};

export function getPrompt(
  category: keyof typeof PROMPTS,
  version?: string
) {
  const prompts = PROMPTS[category];
  const versionKey = version || prompts.current;
  return prompts[versionKey as keyof typeof prompts];
}
```

### 10.2 A/B í…ŒìŠ¤íŠ¸

```typescript
// A/B í…ŒìŠ¤íŠ¸ë¡œ í”„ë¡¬í”„íŠ¸ ì„±ëŠ¥ ë¹„êµ

export async function abTest(
  promptA: string,
  promptB: string,
  testCases: TestCase[]
) {
  const resultsA = await evaluatePrompt(promptA, testCases);
  const resultsB = await evaluatePrompt(promptB, testCases);

  console.log(`Prompt A Score: ${resultsA.avgScore}`);
  console.log(`Prompt B Score: ${resultsB.avgScore}`);

  const winner = resultsA.avgScore > resultsB.avgScore ? 'A' : 'B';
  console.log(`Winner: Prompt ${winner}`);

  return {
    winner,
    scoreA: resultsA.avgScore,
    scoreB: resultsB.avgScore,
    improvement: Math.abs(resultsA.avgScore - resultsB.avgScore),
  };
}
```

---

## ë¶€ë¡ A: ì „ì²´ í”„ë¡¬í”„íŠ¸ ì˜ˆì‹œ

### ì¸ì‚¬ì´íŠ¸ ì¶”ì¶œ ì™„ì „ ë²„ì „

```typescript
export const INSIGHT_EXTRACTION_COMPLETE_PROMPT = {
  system: INSIGHT_EXTRACTION_SYSTEM_PROMPT,
  fewShot: INSIGHT_EXTRACTION_FEW_SHOT,

  user: (transcript: string) => `
${INSIGHT_EXTRACTION_FEW_SHOT}

---

ì´ì œ ì‹¤ì œ ì „ì‚¬ë¡ì…ë‹ˆë‹¤:

${transcript}

ìœ„ ì „ì‚¬ë¡ì—ì„œ ì¸ì‚¬ì´íŠ¸ë¥¼ ì¶”ì¶œí•˜ì„¸ìš”.
JSONë§Œ ë°˜í™˜í•˜ì„¸ìš” (ë‹¤ë¥¸ í…ìŠ¤íŠ¸ ì—†ì´).
`,
};
```

---

## ë¶€ë¡ B: ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬

### ëª©í‘œ ì§€í‘œ

```
ì§€í‘œ                  | ëª©í‘œê°’          | ì¸¡ì • ë°©ë²•
---------------------|-----------------|------------------
ì¸ì‚¬ì´íŠ¸ ì •í™•ë„       | > 80%           | Human evaluation
ê²°ì • ìš”ì†Œ ì™„ê²°ì„±      | > 75%           | 8ìš”ì†Œ ì±„ì›Œì§„ ë¹„ìœ¨
ê°­ ê°ì§€ ì •ë°€ë„        | > 70%           | False positive rate < 30%
ì§ˆë¬¸ ìì—°ìŠ¤ëŸ¬ì›€       | > 4.0/5.0       | User rating
ì‘ë‹µ ì†ë„ (GPT-4)    | < 3ì´ˆ           | API latency
í† í° ì‚¬ìš©ëŸ‰          | < 4000 tok/req  | OpenAI usage
```

---

**ë¬¸ì„œ ë**

**ë‹¤ìŒ ë‹¨ê³„:**
1. í”„ë¡¬í”„íŠ¸ í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ êµ¬ì¶•
2. í‰ê°€ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
3. A/B í…ŒìŠ¤íŠ¸ ì‹¤í–‰
4. ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬
5. í”„ë¡œë•ì…˜ ë°°í¬
6. ì§€ì†ì  ê°œì„  (ì‚¬ìš©ì í”¼ë“œë°± ê¸°ë°˜)
